
-- https://learn.microsoft.com/en-us/azure/synapse-analytics/sql/develop-tables-cetas


SELECT
     *
FROM
    OPENROWSET(
        BULK 'https://olistdatastorageacc1304.dfs.core.windows.net/olisdata/silver/',
        FORMAT = 'PARQUET'
    ) AS result1

--- https://olistdatastorageacc1304.blob.core.windows.net/olisdata/silver/



create schema gold

create view gold.final 
as 
SELECT
     *
FROM
    OPENROWSET(
        BULK 'https://olistdatastorageacc1304.dfs.core.windows.net/olisdata/silver/',
        FORMAT = 'PARQUET'
    ) AS result1

select * from gold.final





https://web.azuresynapse.net/en/authoring/analyze/sqlscripts/view%20final%202?workspace=%2Fsubscriptions%2F733a395f-9cf9-4ddd-a694-4070e3581376%2FresourceGroups%2Fecomm-live%2Fproviders%2FMicrosoft.Synapse%2Fworkspaces%2Folist-synapse




-- CREATE MASTER KEY ENCRYPTION BY PASSWORD = '@nmoL5686';
-- CREATE DATABASE SCOPED CREDENTIAL anmoladmin WITH IDENTITY = 'Managed Identity';

-- select * from sys.database_credentials

CREATE EXTERNAL FILE FORMAT extfileformat WITH (
    FORMAT_TYPE = PARQUET,
    DATA_COMPRESSION = 'org.apache.hadoop.io.compress.SnappyCodec'
);

CREATE EXTERNAL DATA SOURCE goldlayer WITH (
    LOCATION = 'https://olistdatastorageacc1304.dfs.core.windows.net/olisdata/gold/',
    CREDENTIAL = anmoladmin
);

CREATE EXTERNAL TABLE gold.finaltable WITH (
        LOCATION = 'Serving',
        DATA_SOURCE = goldlayer,
        FILE_FORMAT = extfileformat
) AS
SELECT * FROM gold.final;




select * from gold.finaltable

select * from gold.final



